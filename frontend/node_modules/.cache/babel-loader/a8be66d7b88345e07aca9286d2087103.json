{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar React = require('react');\n\nvar ReactDOM = require('react-dom');\n\nfunction _interopDefaultLegacy(e) {\n  return e && typeof e === 'object' && 'default' in e ? e : {\n    'default': e\n  };\n}\n\nvar React__default = /*#__PURE__*/_interopDefaultLegacy(React);\n\nvar ReactDOM__default = /*#__PURE__*/_interopDefaultLegacy(ReactDOM);\n\nvar styles = {\n  \"embedContainer\": \"embed-module_embedContainer__2q9Md\",\n  \"embedModal\": \"embed-module_embedModal__3rP2H\",\n  \"embedIframe\": \"embed-module_embedIframe__30Rog\",\n  \"ldsRing\": \"embed-module_ldsRing__14Ml-\",\n  \"lds-ring\": \"embed-module_lds-ring__2UST5\"\n};\n\nvar PayhereEmbed = function (_a) {\n  var open = _a.open,\n      selector = _a.selector,\n      embedURL = _a.embedURL,\n      customerName = _a.customerName,\n      customerEmail = _a.customerEmail,\n      disableCustomer = _a.disableCustomer,\n      amountInCents = _a.amountInCents,\n      hideAmount = _a.hideAmount,\n      customFields = _a.customFields,\n      onSuccess = _a.onSuccess,\n      onFailure = _a.onFailure,\n      onClose = _a.onClose;\n\n  var _b = React.useState(true),\n      isLoading = _b[0],\n      setLoading = _b[1]; // Don't load in non browser context\n\n\n  if (typeof window === \"undefined\") return null;\n  var origin = window.location.origin;\n  var customFieldsStr = customFields ? btoa(JSON.stringify(customFields)) : \"\";\n  customerEmail = customerEmail ? encodeURIComponent(customerEmail) : \"\";\n  var onMessage = React.useCallback(function (e) {\n    switch (e.data.message) {\n      case \"payhere:ready\":\n        setLoading(false);\n        break;\n\n      case \"payhere:success\":\n        var data_1 = e.data.content;\n        onSuccess(data_1);\n\n        if (data_1.plan && data_1.plan.success_url && data_1.plan.success_url.length > 0) {\n          console.log(\"Redirecting to \" + data_1.plan.success_url);\n          setTimeout(function () {\n            window.location.href = data_1.plan.success_url;\n          }, 2000);\n        }\n\n        break;\n\n      case \"payhere:failure\":\n        onFailure(e.data.content);\n        break;\n\n      case \"payhere:close\":\n        onClose();\n        setLoading(true);\n        break;\n    }\n  }, [onSuccess, onFailure, onClose]);\n  React.useEffect(function () {\n    window.addEventListener(\"message\", onMessage, false);\n    return function () {\n      return window.removeEventListener(\"message\", onMessage, false);\n    };\n  });\n  if (!open) return null;\n  var element = document.querySelector(selector);\n\n  if (!element) {\n    console.error(\"Payhere embed SDK: Element not found with selector '\" + selector + \"'\");\n    return null;\n  }\n\n  return ReactDOM__default['default'].createPortal(React__default['default'].createElement(\"div\", {\n    className: styles.embedContainer\n  }, isLoading && React__default['default'].createElement(\"div\", {\n    className: styles.ldsRing\n  }, React__default['default'].createElement(\"div\", null), React__default['default'].createElement(\"div\", null), React__default['default'].createElement(\"div\", null), React__default['default'].createElement(\"div\", null)), React__default['default'].createElement(\"div\", {\n    className: styles.embedModal,\n    style: {\n      transform: isLoading ? \"scale(0)\" : \"scale(1)\"\n    }\n  }, React__default['default'].createElement(\"iframe\", {\n    className: styles.embedIframe,\n    src: embedURL + \"?embedded=yes&embed_origin=\" + origin + \"&customer_name=\" + (customerName || \"\") + \"&customer_email=\" + (customerEmail || \"\") + \"&disable_customer_fields=\" + (disableCustomer || \"no\") + \"&hide_amount=\" + (hideAmount || \"no\") + \"&amount_in_cents=\" + (amountInCents || \"\") + \"&custom_fields=\" + customFieldsStr\n  }))), element);\n};\n\nexports.default = PayhereEmbed;","map":{"version":3,"sources":["../src/react.tsx"],"names":["useState","useCallback","useEffect","ReactDOM","React"],"mappings":"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","sourcesContent":["import React, { useEffect, useCallback, useState } from \"react\"\nimport ReactDOM from \"react-dom\"\nimport styles from \"./styles/embed.module.css\"\nimport { LaunchProps } from \"./types\"\n\ninterface PayHereReactProps extends LaunchProps {\n  open: boolean\n  selector: string\n  disableCustomer?: \"yes\" | \"no\"\n  hideAmount?: \"yes\" | \"no\"\n}\n\nconst PayhereEmbed: React.FC<PayHereReactProps> = ({\n  open,\n  selector,\n  embedURL,\n  customerName,\n  customerEmail,\n  disableCustomer,\n  amountInCents,\n  hideAmount,\n  customFields,\n  onSuccess,\n  onFailure,\n  onClose,\n}) => {\n  const [isLoading, setLoading] = useState(true)\n\n  // Don't load in non browser context\n  if (typeof window === \"undefined\") return null\n\n  const origin = window.location.origin\n  const customFieldsStr = customFields ? btoa(JSON.stringify(customFields)) : \"\"\n  customerEmail = customerEmail ? encodeURIComponent(customerEmail) : \"\"\n\n  const onMessage = useCallback(\n    (e) => {\n      switch (e.data.message) {\n        case \"payhere:ready\":\n          setLoading(false)\n          break\n        case \"payhere:success\":\n          const data = e.data.content\n          onSuccess(data)\n          if (\n            data.plan &&\n            data.plan.success_url &&\n            data.plan.success_url.length > 0\n          ) {\n            console.log(\"Redirecting to \" + data.plan.success_url)\n            setTimeout(() => {\n              window.location.href = data.plan.success_url\n            }, 2000)\n          }\n          break\n        case \"payhere:failure\":\n          onFailure(e.data.content)\n          break\n        case \"payhere:close\":\n          onClose()\n          setLoading(true)\n          break\n      }\n    },\n    [onSuccess, onFailure, onClose]\n  )\n\n  useEffect(() => {\n    window.addEventListener(\"message\", onMessage, false)\n    return () => window.removeEventListener(\"message\", onMessage, false)\n  })\n\n  if (!open) return null\n\n  const element = document.querySelector<HTMLElement>(selector)\n\n  if (!element) {\n    console.error(\n      `Payhere embed SDK: Element not found with selector '${selector}'`\n    )\n    return null\n  }\n\n  return ReactDOM.createPortal(\n    <div className={styles.embedContainer}>\n      {isLoading && (\n        <div className={styles.ldsRing}>\n          <div></div>\n          <div></div>\n          <div></div>\n          <div></div>\n        </div>\n      )}\n      <div\n        className={styles.embedModal}\n        style={{ transform: isLoading ? `scale(0)` : `scale(1)` }}\n      >\n        <iframe\n          className={styles.embedIframe}\n          src={`${embedURL}?embedded=yes&embed_origin=${origin}&customer_name=${\n            customerName || \"\"\n          }&customer_email=${customerEmail || \"\"}&disable_customer_fields=${\n            disableCustomer || \"no\"\n          }&hide_amount=${hideAmount || \"no\"}&amount_in_cents=${\n            amountInCents || \"\"\n          }&custom_fields=${customFieldsStr}`}\n        ></iframe>\n      </div>\n    </div>,\n    element\n  )\n}\n\nexport default PayhereEmbed\n"]},"metadata":{},"sourceType":"script"}